\chapter{Preliminary}

\section{Empirical Spectral Measure}

\begin{definition}[Empirical Spectral Measure]
    For a symmetric matrix $\mathbf{M}\in\mathbb{R}^{n\times n}$, the spectral measure or empirical spectral measure or empirical spectral distribution (ESD) $\mu_{\mathbf{M}}$ of $\mathbf{M}$ is defined as the normalized counting measure of the eigenvalues $\lambda_{1}(\mathbf{M}),\ldots,\lambda_{n}(\mathbf{M})$ of $\mathbf{M}$, i.e.,
    \begin{equation}
        \mu_{\mathbf{M}}:=\frac{1}{n}\sum_{i=1}^{n}\delta_{\lambda_{i}(\mathbf{M})}
    \end{equation}
    where $\delta_{x}$ is a Dirac measure for any (measurable) set, that
    \begin{equation*}
        \delta_{x}(A):=\mathbf{1}_{A}(x)=
        \begin{cases}
            0, & x\notin A \\
            1, & x\in A
        \end{cases}
    \end{equation*}
    Since $\int\mu_{\mathbf{M}}\left(\mathrm{d}x\right)=1$, the spectral measure $\mu_{\mathbf{M}}$ of a matrix $\mathbf{M}\in\mathbb{R}^{n\times n}$ (random or not) is a probability measure.
\end{definition}

\begin{remark}
    Many important statistics in multivariate analysis can be expressed as functionals of the ESD, such as, for $\mathbf{M}$ be an $n\times n$ positive definite matrix, then
    \begin{equation}
        \operatorname{det}(\mathbf{M})=\prod_{i=1}^{n}\lambda_{i}=\exp\left(n\int_{0}^{\infty}\log x\mu_{\mathbf{M}}(\mathrm{d}x)\right)
    \end{equation}
\end{remark}

\section{Stieltjes Transform}

\begin{definition}[Resolvent]
    For a symmetric matrix $\mathbf{M}\in\mathbb{R}^{n\times n}$, the resolvent $\mathbf{Q}_{\mathbf{M}}(z)$ of $\mathbf{M}$ is defined as
    \begin{equation}
        \mathbf{Q}_{\mathbf{M}}(z):=\left(\mathbf{M}-z\mathbf{I}_{n}\right)^{-1}
    \end{equation}
    where $z\in\mathbb{C}$ not eigenvalue of $\mathbf{M}$.
\end{definition}

\begin{definition}[Stieltjes Transform]
    For a real probability measure $\mu$ with support $\operatorname{supp}(\mu)$, the Stieltjes transform $m_{\mu}(z)$ is defined as
    \begin{equation}
        m_{\mu}(z):=\int\frac{1}{t-z}\mu\left(\mathrm{d}t\right)
    \end{equation}
    where $z\in\mathbb{C}\backslash\operatorname{supp}(\mu)$.
\end{definition}

\begin{property}
    The Stieltjes transform $m_{\mu}$ has numerous interesting properties:
    \begin{enumerate}
        \item it is complex analytic on its domain of definition $\mathbb{C} \backslash \operatorname{supp}(\mu)$.
        \item it is bounded $\left|m_{\mu}(z)\right|\leq 1/\operatorname{dist}(z,\operatorname{supp}(\mu))$.
        \item it satisfies $\Im[z]>0 \Rightarrow \Im[m(z)]>0$.
        \item it is an increasing function on all connected components of its restriction to $\mathbb{R}\backslash\operatorname{supp}(\mu)$. % (since $m_{\mu}^{\prime}(x)=\int(t-x)^{-2} \mu(d t)>0$)
        \item if $\operatorname{supp}(\mu)$ is bounded, $\lim_{x\rightarrow\pm\infty}m_{\mu}(x)=0$.
    \end{enumerate}
\end{property}

\begin{remark}
    Most of the results involve Stieltjes transforms $m_{\mu}(z)$ of a real probability measure with support $\operatorname{supp}(\mu) \subset \mathbb{R} .$ Since Stieltjes transforms are such that
    \begin{equation*}
        m_{\mu}(z)>0,\forall z<\inf\operatorname{supp}(\mu),\quad m_{\mu}(z)<0,\forall z>\sup \operatorname{supp}(\mu),\quad\Im[z] \Im\left[m_{\mu}(z)\right]>0,\text{ if }z\in\mathbb{C}\backslash\mathbb{R}
    \end{equation*}
    it will be convenient in the following to consider the set of scalar pairs
    \begin{equation*}
        \begin{array}{c}
            \mathcal{Z}(\mathcal{A})=\left\{(z,m)\in\mathcal{A}\times\mathbb{C},(\Im[z]\Im[m]>0\text{ if } \Im[z] \neq 0)\text{ or }\left(m>0\text{ if }z<\inf \mathcal{A}^{c} \cap \mathbb{R}\right)\right. \\
            \left.\text{ or }\left(m<0\text{ if }z>\sup \mathcal{A}^{c} \cap \mathbb{R}\right)\right\}
        \end{array}
    \end{equation*}
\end{remark}

As a transform, $m_{\mu}$ has an inverse formula to recover $\mu$, as per the following result.

\begin{theorem}[Inverse Stieltjes Transform] \label{thm:inverse-stieltjes-transform}
    For $a,b$ continuity points of the probability measure $\mu$, we have
    \begin{equation}
        \mu\left([a,b]\right)=\frac{1}{\pi}\lim_{y\downarrow 0}\int_{a}^{b}\Im\left[m_{\mu}(x+\imath y)\right]\,\mathrm{d}x
    \end{equation}
    Specially, if $\mu$ has a density $f$ at $x$, then
    \begin{equation}
        f(x)=\frac{1}{\pi}\lim_{y\downarrow 0}\Im\left[m_{\mu}(x+\imath y)\right]
    \end{equation}
    And, if $\mu$ has an isolated mass at $x$, then
    \begin{equation}
        \mu(\{x\})=\lim_{y \downarrow 0}-\imath y m_{\mu}(x+\imath y)
    \end{equation}
\end{theorem}

\begin{proof}
    \begin{equation*}
        \begin{aligned}
            \frac{1}{\pi}\int_{a}^{b}\Im\left[m_{\mu}(x+\imath y)\right]\,\mathrm{d}x= & \frac{1}{\pi}\int_{a}^{b}\left\{\int\Im\left[\frac{1}{(t-x)-\imath y}\right]\mu(\mathrm{d}t)\right\}\,\mathrm{d}x \\
            =                                                                          & \frac{1}{\pi}\int_{a}^{b}\left[\int\frac{y}{(t-x)^{2}+y^{2}}\mu(\mathrm{d}t)\right]\,\mathrm{d}x
        \end{aligned}
    \end{equation*}
    By Fubini's theorem,
    \begin{equation*}
        \begin{aligned}
            = & \frac{1}{\pi}\int\left[\int_{a}^{b}\frac{y}{(t-x)^{2}+y^{2}}\,\mathrm{d}x\right]\mu(\mathrm{d}t)                  \\
            = & \frac{1}{\pi}\int\left[\arctan\left(\frac{b-t}{y}\right)-\arctan\left(\frac{a-t}{y}\right)\right]\mu(\mathrm{d}t)
        \end{aligned}
    \end{equation*}

    Since
    \begin{equation*}
        \left|\frac{y}{(t-x)^{2}+y^{2}}\right|\leq\frac{1}{y},\quad\forall y>0
    \end{equation*}
    by the dominated convergence theorem,
    \begin{equation*}
        \frac{1}{\pi}\lim_{y\downarrow 0}\int_{a}^{b}\Im\left[m_{\mu}(x+\imath y)\right]\,\mathrm{d}x=\frac{1}{\pi}\int\lim_{y\downarrow 0}\left[\arctan\left(\frac{b-t}{y}\right)-\arctan\left(\frac{a-t}{y}\right)\right]\mu(\mathrm{d}t)
    \end{equation*}
    as $y\downarrow 0$, the difference in brackets converges either to $\pm \pi$ or 0 depending on the relative position of $a,b$ and $t$, thus
    \begin{equation*}
        =\int\mathrm{1}_{[a,b]}\mu(\mathrm{d}t)=\mu\left([a,b]\right)
    \end{equation*}
    Thus, if $\mu$ has a density $f$ at $x$, then
    \begin{equation*}
        f(x)=\frac{1}{\pi}\lim_{y\downarrow 0}\Im\left[m_{\mu}(x+\imath y)\right]
    \end{equation*}

    When $\mu$ has an isolated mass at $x$, i.e., $\mu(d t)=a \delta_{x}(t)$, similarly, since
    \begin{equation*}
        |y(t-x)|\leq\frac{1}{2}\left(y^{2}+(t-x)^{2}\right)
    \end{equation*}
    by dominated convergence theorem,
    \begin{equation*}
        \lim_{y\downarrow 0}-\imath ym_{\mu}(x+\imath y)=-\lim_{y\downarrow 0}\int\frac{\imath y(t-x)\mu(\mathrm{d}t)}{(t-x)^{2}+y^{2}}+\lim_{y\downarrow 0}\int\frac{y^{2}\mu(\mathrm{d}t)}{(t-x)^{2}+y^{2}}=a
    \end{equation*}
\end{proof}

\begin{remark}
    The important relation between the empirical spectral measure $\mu_{\mathbf{M}}$ of $\mathbf{M}\in\mathbb{R}^{n\times n}$, the Stieltjes transform $m_{\mu_{\mathbf{M}}}(z)$ and the resolvent $\mathbf{Q}_{\mathbf{M}}(z)$ lies in the fact that
    \begin{equation} \label{eq:relation-between-empirical-spectral-measures-stieltjes-transform-and-its-resolvent}
        m_{\mu_{\mathbf{M}}}(z)=\frac{1}{n}\sum_{i=1}^{n}\int\frac{\delta_{\lambda_{i}(\mathbf{M})}(t)}{t-z}=\frac{1}{n}\sum_{i=1}^{n}\frac{1}{\lambda_{i}(\mathbf{M})-z}=\frac{1}{n}\operatorname{tr}\mathbf{Q}_{\mathbf{M}}(z)
    \end{equation}
\end{remark}

The resolvent $\mathbf{Q}_{\mathbf{M}}$ provides access to scalar observations of the eigenspectrum of $\mathbf{M}$ through its linear functionals. Cauchyâ€™s integral formula provides a connection between the linear functionals of the eigenvalues of $\mathbf{M}$ and the Stieltjes transform $m_{\mu_{\mathbf{M}}}(z)$ through
\begin{equation}
    \frac{1}{n}\sum_{i=1}^{n}f\left(\lambda_{i}(\mathbf{M})\right)=-\frac{1}{2\pi\imath n}\oint_{\Gamma}f(z)\operatorname{tr}\left(\mathbf{Q}_{\mathbf{M}}(z)\right)\mathrm{d}z=-\frac{1}{2\pi\imath }\oint_{\Gamma}f(z)m_{\mu_{\mathbf{M}}}(z)\mathrm{d}z
\end{equation}
for all $f$ complex analytic in a compact neighborhood of $\operatorname{supp}\left(\mu_{\mathbf{M}}\right)$, by choosing the contour $\Gamma$ to enclose $\operatorname{supp}\left(\mu_{\mathbf{M}}\right)$ (i.e., all the eigenvalues $\lambda_{i}(\mathbf{M})$).

\section{Matrix Equivalents}

\begin{definition}[Deterministic Equivalent]
    $\overline{\mathbf{Q}}\in\mathbb{R}^{n\times n}$ is said to be deterministic equivalent for the symmetric random matrix $\mathbf{Q}\in\mathbb{R}^{n\times n}$, if for a (sequences of) deterministic matrix $\mathbf{A}\in\mathbb{R}^{n\times n}$ and vectors $\mathbf{a},\mathbf{b}\in\mathbb{R}^{n}$ of unit norms (operator and Euclidean, respectively),
    \begin{equation}
        \frac{1}{n}\operatorname{tr}\mathbf{A}(\mathbf{Q}-\overline{\mathbf{Q}})\rightarrow 0,\quad\mathbf{a}^{\prime}(\mathbf{Q}-\overline{\mathbf{Q}})\mathbf{b}\rightarrow 0,\quad\text{ as }n\rightarrow\infty
    \end{equation}
    where the convergence is either in probability or almost sure.
\end{definition}

\begin{remark}
    A practical use of deterministic equivalents is to establish that, for a random matrix $\mathbf{M}$ of interest, suppose
    \begin{equation*}
        \frac{1}{n}\operatorname{tr}\left(\mathbf{Q}_{\mathbf{M}}(z)-\overline{\mathbf{Q}}(z)\right)\rightarrow 0,\quad\text{a.s.},\quad\forall z\in\mathcal{C} ,\mathcal{C}\subset\mathbb{C}
    \end{equation*}
    this convergence implies that the Stieltjes transform of $\mu_{\mathrm{M}}$ "converges" in the sense that
    \begin{equation*}
        m_{\mu_{\mathrm{M}}}(z)-\bar{m}_{n}(z)\rightarrow 0
    \end{equation*}
    where $\bar{m}_{n}(z)=\frac{1}{n}\operatorname{tr}\overline{\mathbf{Q}}(z)$.
\end{remark}

\begin{definition}[Matrix Equivalents]
    For $\mathbf{X},\mathbf{Y}\in\mathbb{R}^{n \times n}$ two random or deterministic matrices, we write
    \begin{equation}
        \mathbf{X}\leftrightarrow\mathbf{Y}
    \end{equation}
    if, for all $\mathbf{A}\in\mathbb{R}^{n\times n}$ and $\mathbf{a},\mathbf{b}\in\mathbb{R}^{n}$ of unit norms (respectively, operator and Euclidean), we have the simultaneous results
    \begin{equation*}
        \frac{1}{n}\operatorname{tr}\mathbf{A}(\mathbf{X}-\mathbf{Y})\rightarrow 0,\quad \mathbf{a}^{\prime}(\mathbf{X}-\mathbf{Y})\mathbf{b}\rightarrow 0,\quad\|\mathbb{E}[\mathbf{X}-\mathbf{Y}]\|\rightarrow 0
    \end{equation*}
    where, for random quantities, the convergence is either in probability or almost sure.
\end{definition}

\section{Resolvent and Perturbation Identities}

\begin{lemma}[Resolvent Identity] \label{lem:resolvent-identity}
    For invertible matrices $\mathbf{A}$ and $\mathbf{B}$, we have
    \begin{equation}
        \mathbf{A}^{-1}-\mathbf{B}^{-1}=\mathbf{A}^{-1}\left(\mathbf{B}-\mathbf{A}\right)\mathbf{B}^{-1}
    \end{equation}
\end{lemma}

\begin{lemma}[Sherman-Morrison] \label{lem:sherman-morrison}
    For $\mathbf{A}\in\mathbb{R}^{n\times n}$ invertible and $\mathbf{u},\mathbf{v}\in\mathbb{R}^{n}$, then $\mathbf{A}+\mathbf{u}\mathbf{v}^{\prime}$ is invertible if and only if $1+\mathbf{v}^{\prime}\mathbf{A}^{-1}\mathbf{u}\neq 0$ and
    \begin{equation}
        \left(\mathbf{A}+\mathbf{u}\mathbf{v}^{\prime}\right)^{-1}=\mathbf{A}^{-1}-\frac{\mathbf{A}^{-1}\mathbf{u}\mathbf{v}^{\prime}\mathbf{A}^{-1}}{1+\mathbf{v}^{\prime}\mathbf{A}^{-1}\mathbf{u}}
    \end{equation}
    or,
    \begin{equation}
        \left(\mathbf{A}+\mathbf{u}\mathbf{v}^{\prime}\right)^{-1}\mathbf{u}=\frac{\mathbf{A}^{-1}\mathbf{u}}{1+\mathbf{v}^{\prime}\mathbf{A}^{-1}\mathbf{u}}
    \end{equation}
\end{lemma}

\begin{lemma}[Quadratic-form-close-to-the-trace] \label{lem:quadratic-form-close-to-the-trace}
    Let $\mathbf{x} \in \mathbb{R}^{p}$ have i.i.d. entries of zero mean, unit variance and $\mathbb{E}\left[\left|x_{i}\right|^{K}\right] \leq \nu_{K}$ for some $K \geq 1 .$ Then for $\mathbf{A} \in \mathbb{R}^{p \times p}$ and $k \geq 1$
    $$
        \mathbb{E}\left[\left|\mathbf{x}^{\prime} \mathbf{A} \mathbf{x}-\operatorname{tr} \mathbf{A}\right|^{k}\right] \leq C_{k}\left[\left(\nu_{4} \operatorname{tr}\left(\mathbf{A} \mathbf{A}^{\prime}\right)\right)^{k / 2}+\nu_{2 k} \operatorname{tr}\left(\mathbf{A} \mathbf{A}^{\prime}\right)^{k / 2}\right]
    $$
    for some constant $C_{k}>0$ independent of $p .$ In particular, if $\|\mathbf{A}\| \leq 1$ and the entries of $\mathrm{x}$ have bounded eighth-order moment,
    $$
        \mathbb{E}\left[\left(\mathbf{x}^{\prime} \mathbf{A} \mathbf{x}-\operatorname{tr} \mathbf{A}\right)^{4}\right] \leq C p^{2}
    $$
    for some $C>0$ independent of $p$, and consequently, as $p \rightarrow \infty$,
    $$
        \frac{1}{p} \mathbf{x}^{\prime} \mathbf{A} \mathbf{x}-\frac{1}{p} \operatorname{tr} \mathbf{A} \stackrel{\text { a.s. }}{\longrightarrow} 0
    $$
\end{lemma}
